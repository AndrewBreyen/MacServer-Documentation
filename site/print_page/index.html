
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://andrewbreyen.github.io/MacServer-Documentation/print_page/">
      
      <link rel="icon" href="../img/macmini-icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Print Site - MacServer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("/MacServer-Documentation/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MacServer Documentation" class="md-header__button md-logo" aria-label="MacServer Documentation" data-md-component="logo">
      
  <img src="../img/macmini-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MacServer Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../setup/first-time-setup/" class="md-tabs__link">
        Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../server-apps/macos-server/" class="md-tabs__link">
        Server Apps
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../hardware/hardware/" class="md-tabs__link">
        Hardware
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../troubleshooting/reboot/" class="md-tabs__link">
        Troubleshooting
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MacServer Documentation" class="md-nav__button md-logo" aria-label="MacServer Documentation" data-md-component="logo">
      
  <img src="../img/macmini-icon.png" alt="logo">

    </a>
    MacServer Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/first-time-setup/" class="md-nav__link">
        First Time Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/first-time-setup-ventura/" class="md-nav__link">
        Ventura First Time Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/macos-settings/" class="md-nav__link">
        macOS Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/jumpcloud/" class="md-nav__link">
        Jumpcloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/apple-remote-desktop/" class="md-nav__link">
        Apple Remote Desktop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/installs/" class="md-nav__link">
        Installs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Server Apps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Server Apps" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Server Apps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/macos-server/" class="md-nav__link">
        macOS Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/teamviewer/" class="md-nav__link">
        TeamViewer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/jellyfin/" class="md-nav__link">
        Jellyfin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/homebridge/" class="md-nav__link">
        Homebridge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/scrypted/" class="md-nav__link">
        Scrypted
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/node-red/" class="md-nav__link">
        Node-RED
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/pihole/" class="md-nav__link">
        Pihole
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/tdarr/" class="md-nav__link">
        Tdarr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-apps/timemachine-editor/" class="md-nav__link">
        Time Machine Editor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Hardware
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hardware" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Hardware
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/hardware/" class="md-nav__link">
        Hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hardware/zigbee-conbee/" class="md-nav__link">
        Zigbee-Conbee
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/reboot/" class="md-nav__link">
        Reboot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/live-tv-data-issues/" class="md-nav__link">
        Live TV Guide Data Issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/no-response-homekit/" class="md-nav__link">
        Smart Devices showing as “No Response”/Orange Exclamation mark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/network-change-smart-home/" class="md-nav__link">
        Network Change: Smart Home Devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/ventura-update/" class="md-nav__link">
        Ventura Update: Issues and Solutions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section id="print-site-cover-page">
            
<div>

    
        <h1>MacServer Documentation</h1>
    

</div>


<table>

    

    

    

    
    <tr>
        <td>Copyright</td>
        <td><a href=/MacServer-Documentation/attributions>Attributions</a></td>
    </tr>
    

</table>





        </section>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="6">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-welcome-to-macserver-documentation">Welcome to MacServer Documentation</h1>
<p>This wiki contains documentation on how MacServer is set up and used.</p></section>
                        <h1 class='nav-section-title' id='section-setup'>
                            Setup <a class='headerlink' href='#section-setup' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="setup-first-time-setup"><h1 id="setup-first-time-setup-first-time-setup">First Time Setup</h1>
<h2 id="setup-first-time-setup-setup-assistant">Setup Assistant</h2>
<div class="admonition quote">
<p class="admonition-title"><a href="https://support.apple.com/guide/mac-mini/set-up-your-mac-apd831707cb3/mac">Mac mini Essentials Documentation - Set up your Mac</a></p>
<p>The first time your Mac mini starts up, Setup Assistant walks you through the simple steps needed to start using your new Mac. You can respond to all the prompts, or skip some steps and choose to complete them later.</p>
</div>
<p>Follow the steps in Setup Assistant, including internet connection, Apple ID sign-in, etc.</p>
<p>Keep unnecesary features turned off (screen time, Apple Pay, Store Files in iCloud, restore from backup, etc)</p>
<h2 id="setup-first-time-setup-users">Users</h2>
<p>When first setting up the Mac, create a generic “MacMini” (or whatever type of Mac) admin user. Take note of the password chosen.</p>
<p>This user will be logged in and serving apps/content. </p>
<h2 id="setup-first-time-setup-network">Network</h2>
<p>The Mac needs to have a Static IP address for many purposes. </p>
<ol>
<li>Find the Ethernet Mac Address under Apple Menu (hold <span class="keys"><kbd class="key-option">Option</kbd></span>) -&gt; System Information -&gt; Network</li>
<li>Open the eero app</li>
<li>Go to Settings -&gt; Network Settings -&gt; Reservations and Port Forwarding</li>
<li>Pick 'Add a reservation'</li>
<li>Scroll to the bottom of the list, and choose 'Enter manually'</li>
<li>
<p>Enter an IP Address to use. For convienence, use a low-number IP address (192.168.4.2)</p>
<p>The IP address spreified must not be already in use, and must be within the subnet range.</p>
<p>Keep the first three groups of numbers the same, and only change the last group. (eg 192.168.4.##)</p>
</li>
<li>
<p>Enter the MAC Address noted previously from System Information, using format <code>XX:XX:XX:XX:XX:XX</code></p>
</li>
<li>Click 'Save'</li>
<li>Reboot Mac, and ensure that IP address listed in System Preferences is 192.168.4.2</li>
</ol>
<div class="admonition info">
<p class="admonition-title">If the IP address does not take effect:</p>
<ol>
<li>Reboot the mac again -- it may need to re-handshake with the network</li>
<li>Forget the network and re-join</li>
<li>Reboot the eero network from the eero app</li>
</ol>
</div>
<h2 id="setup-first-time-setup-once-to-the-desktop">Once to the desktop...</h2>
<ol>
<li>Create Shared Folders<ul>
<li><code>/Users/Shared/Scans</code></li>
<li><code>/Users/Shared/AllShare</code></li>
<li><code>/Users/Shared/xmltvdata</code> (used for TV Guide Data Docker Container)</li>
<li><code>/Users/Shared/nodered_data</code> (used for Node-RED Docker Container)</li>
</ul>
</li>
<li>Create other users:<ul>
<li>andrew</li>
<li>matt</li>
<li>dan</li>
<li>nancy</li>
</ul>
</li>
<li>If installed, add Jellyfin to System Prefrences -&gt; Users and Groups -&gt; macmini -&gt; Login Items and [CHECK] Hide</li>
<li>Turn off Wifi from the menu bar</li>
</ol></section><section class="print-page" id="setup-first-time-setup-ventura"><h1 id="setup-first-time-setup-ventura-ventura-first-time-setup">Ventura First Time Setup</h1>
<ol>
<li>setup mac with macmini user</li>
<li>set static IP</li>
<li>Add file shares</li>
<li>Install chrome</li>
<li>Set up Time Machine and <a href="#server-apps-timemachine-editor">Time Machine Editor</a></li>
<li>install JellyFin using <a href="#server-apps-jellyfin">Jellyfin Docs</a></li>
<li>Install PiHole using <a href="#server-apps-pihole">PiHole Docs</a></li>
<li>Install Homebridge using <a href="#server-apps-homebridge">Homebridge Docs</a></li>
</ol></section><section class="print-page" id="setup-macos-settings"><h1 id="setup-macos-settings-macos-settings">macOS Settings</h1>
<p>Make these changes in macOS System Preferences</p>
<h2 id="setup-macos-settings-users-and-groups">Users and Groups</h2>
<h3 id="setup-macos-settings-login-options">Login Options</h3>
<p>Enable automatic login for the MacMini user</p>
<h3 id="setup-macos-settings-macmini-login-items">macmini -&gt; Login Items</h3>
<p>Automatically start apps on MacMini user login</p>
<ul>
<li>Docker</li>
<li>Jellyfin</li>
</ul>
<h2 id="setup-macos-settings-energy-saver">Energy Saver</h2>
<ul>
<li>Turn Display Off after: never</li>
</ul>
<p><span class="twemoji" title="Important information"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11 9h2V7h-2m1 13c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m-1 15h2v-6h-2v6Z"></path></svg></span>: testing setting this to 3 minutes</p>
<ul>
<li>[CHECK] Prevent your Mac from automatically sleeping when the display is off</li>
<li>[CHECK] Put hard disks to sleep when possible</li>
<li>[CHECK] Wake for network access</li>
<li>[CHECK] Start up automatically after a power failure</li>
<li>[CHECK] Enable Power Nap</li>
</ul>
<p>Schedule:</p>
<ul>
<li>Set to restart on Sundays at 4 AM</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Change in macOS Ventura</p>
<p>macOS has changed the way power schedule is set in macOS Ventura. See updated documentation <a href="#troubleshooting-ventura-update-scheduled-reboot">here</a></p>
</div>
<h2 id="setup-macos-settings-security-and-privacy">Security and Privacy</h2>
<h3 id="setup-macos-settings-privacy-full-disk-access">Privacy -&gt; Full Disk Access</h3>
<ul>
<li>Ensure <code>/bin/bash</code> is added to this list</li>
</ul>
<h2 id="setup-macos-settings-sharing">Sharing</h2>
<p>Ensure 'Computer Name' is set to <code>MacServer</code></p>
<h3 id="setup-macos-settings-file-sharing">File Sharing</h3>
<p>Add folders: </p>
<ul>
<li>/Users/Shared/macOS Server Shares/AllShare</li>
<li>​/Users/Shared/macOS Server Shares/Scans</li>
</ul>
<p>Add volumes:</p>
<ul>
<li>/Volumes/Media</li>
<li>/Volumes/Time Machine Backups</li>
</ul>
<p>Enable Time Machine Backups:</p>
<ul>
<li>Right Click <code>Time Machine Backups</code> -&gt; Advanced Options -&gt; [CHECK] Share as a Time Machine backup destination  </li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/setup/time-machine-sharing-advanced-options.png"><img alt="jellyfin-tv-guide-data-providers.png" src="../img/setup/time-machine-sharing-advanced-options.png" width="200"/></a>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/setup/time-machine-sharing-advanced-options-menu.png"><img alt="jellyfin-tv-guide-data-providers.png" src="../img/setup/time-machine-sharing-advanced-options-menu.png" width="300"/></a></p>
<p>Permissions:</p>
<p>For all folders and volumes:</p>
<ul>
<li>‘Everyone’: Read Only</li>
<li>'AllLocalUsers': Read &amp; Write</li>
</ul>
<h3 id="setup-macos-settings-remote-login">Remote Login</h3>
<ul>
<li>[CHECK] Allow full disk access for remote users</li>
<li>Allow access for: Only these users -&gt; <code>AllLocalUsers</code></li>
</ul>
<h3 id="setup-macos-settings-remote-management">Remote Management</h3>
<ul>
<li>Allow access for: <code>Only these users</code> -&gt; click '+' and add all users.</li>
<li>When prompted for permissions, enable everything.</li>
<li>Computer Settings:<ul>
<li>[CHECK] Always show Remote Management status in menu bar</li>
<li>[CHECK] Anyone may request permission to control screen</li>
</ul>
</li>
</ul>
<h3 id="setup-macos-settings-remote-apple-events">Remote Apple Events</h3>
<ul>
<li>Allow access for: <code>All users</code></li>
</ul>
<h3 id="setup-macos-settings-content-caching">Content Caching</h3>
<ul>
<li>Cache: <code>All content</code></li>
<li>Options<ul>
<li>Cache Location: <code>Macintosh HD</code></li>
<li>Cache size: <code>30 GB</code> (change as needed)</li>
</ul>
</li>
</ul></section><section class="print-page" id="setup-jumpcloud"><h1 id="setup-jumpcloud-jumpcloud">Jumpcloud</h1>
<p>WIP</p></section><section class="print-page" id="setup-apple-remote-desktop"><h1 id="setup-apple-remote-desktop-apple-remote-desktop">Apple Remote Desktop</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Once initial setup is completed with a keyboard, mouse, and display directly connected to the Mac, Remote Desktop can be used to remotely control the Mac when there are no peripherals attatched. </p>
</div>
<p>To add MacServer to Apple Remote Desktop:</p>
<p>On the client machine:</p>
<ol>
<li>Download <a href="https://apps.apple.com/us/app/apple-remote-desktop/id409907375">ARD from Mac App Store</a></li>
<li>Go through initial setup</li>
<li>Once to the main screen, select 'Scanner' from the left hand side</li>
<li>Ensure 'Bonjour' is selected on top bar, and drag 'MacServer' into 'All Computers'</li>
<li>Enter the <code>macmini</code> user and password</li>
<li>Once 'Current Status' changes to 'Available', click 'Control' or choose Interact -&gt; Control from the menu bar.</li>
</ol></section><section class="print-page" id="setup-installs"><h1 id="setup-installs-installs">Installs</h1>
<p>Install these things.</p>
<h2 id="setup-installs-brew">Brew</h2>
<p>In a terminal, run:
<div class="highlight"><pre><span></span><code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
</code></pre></div></p>
<h2 id="setup-installs-python">Python</h2>
<p>In a terminal, run:
<div class="highlight"><pre><span></span><code>brew install python3
</code></pre></div></p>
<h2 id="setup-installs-apps">Apps</h2>
<ul>
<li>VSCode</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Setup</h1>
                        <h1 class='nav-section-title' id='section-server-apps'>
                            Server Apps <a class='headerlink' href='#section-server-apps' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="server-apps-macos-server"><h1 id="server-apps-macos-server-macos-server">macOS Server</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As of April 21, 2022, Apple has discontinued macOS Server. Existing macOS Server customers can continue to download and use the app with macOS Monterey.</p>
<p>Many of the features of macos Server are already available built-in to macOS, and many features of macOS Server are not used in this MacServer environment.</p>
<p>For more details see <a href="https://support.apple.com/en-us/HT208312">https://support.apple.com/en-us/HT208312</a></p>
</div>
<p>Download macOS Server from the App Store</p>
<h2 id="server-apps-macos-server-users">Users</h2>
<p>Create users within macOS Server app for Dan/Nancy/Matt/Andrew</p>
<h2 id="server-apps-macos-server-groups">Groups</h2>
<p>Create a User Group <code>AllLocalUsers</code> with all local users</p></section><section class="print-page" id="server-apps-docker"><h1 id="server-apps-docker-docker">Docker</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Docker is used to create Containers.</p>
<p>"A Docker container image is a lightweight, standalone, executable package of software that includes everything needed to run an application: code, runtime, system tools, system libraries and settings." (<a href="https://www.docker.com/resources/what-container/">docker.com</a>)</p>
</div>
<p>Download and install Docker from <a href="https://www.docker.com/">https://www.docker.com/</a></p>
<p>Once installed, Open Settings and:</p>
<ol>
<li>General <ul>
<li>Check 'Start Docker Desktop when you log in'</li>
<li>Uncheck 'Open Docker Dashboard at startup'</li>
</ul>
</li>
<li>Resources -&gt; Advanced<ul>
<li>CPUs: 2</li>
<li>Memory: 2.00 GB</li>
<li>Swap: 1 GB</li>
<li>Disk image size: 16 GB</li>
</ul>
</li>
<li>Resources -&gt; File Sharing<ul>
<li>Delete any existing file shares, and add:</li>
<li><code>/Users/Shared/nodered_data</code></li>
<li><code>/Users/Shared/xmltvdata</code></li>
</ul>
</li>
</ol></section><section class="print-page" id="server-apps-teamviewer"><h1 id="server-apps-teamviewer-teamviewer">TeamViewer</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Teamviewer is used for Remote Desktop access to the computer off-network. </p>
</div>
<p>Install TeamViewer from <a href="https://www.teamviewer.com/en-us/download/mac-os/">https://www.teamviewer.com/en-us/download/mac-os/</a><br/>
Login with account
Enable unattended access:</p>
<ul>
<li>[CHECK] Start TeamViewer with System</li>
<li>[CHECK] Grant Andrew Breyen Easy Access</li>
</ul></section><section class="print-page" id="server-apps-jellyfin"><h1 id="server-apps-jellyfin-jellyfin">Jellyfin</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Jellyfin is used to serve media content, manage and record live TV content, and more. </p>
</div>
<h2 id="server-apps-jellyfin-download">Download</h2>
<p>Download the latest version of <code>installer/jellyfin_x.x.x.dmg</code>from <a href="https://repo.jellyfin.org/releases/server/macos/versions/stable/installer/">https://repo.jellyfin.org/releases/server/macos/versions/stable/installer/</a></p>
<p>Open downloaded file, drag Jellyfin to Applications folder</p>
<h2 id="server-apps-jellyfin-add-to-login-items">Add to Login Items</h2>
<p>Add Jellyfin to Login Items</p>
<p>macOS System Settings -&gt; General -&gt; Login Items</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/server-apps/jellyfin/jellyfin-systemsettings-loginitems.png"><img alt="jellyfin-systemsettings-loginitems.png" src="../img/server-apps/jellyfin/jellyfin-systemsettings-loginitems.png" width="250"/></a> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/server-apps/jellyfin/jellyfin-systemsettings-loginitems-jellyfin.png"><img alt="jellyfin-systemsettings-loginitems-jellyfin.png" src="../img/server-apps/jellyfin/jellyfin-systemsettings-loginitems-jellyfin.png" width="250"/></a></p>
<h2 id="server-apps-jellyfin-open-web-ui">Open Web UI</h2>
<p>Click the 
  <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/jellyfin/jellyfin-menubar.png"><img alt="jellyfin-menubar.png" src="../img/jellyfin/jellyfin-menubar.png" width="50"/></a> icon in the menu bar and choose 'Launch Web UI' <br/> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/jellyfin/jellyfin-menubar-openui.png"><img alt="jellyfin-menubar-openui.png" src="../img/jellyfin/jellyfin-menubar-openui.png" width="200"/></a></p>
<p>Setup Jellyfin</p>
<ul>
<li>Default settings</li>
<li>Create a primary Admin user</li>
</ul>
<h2 id="server-apps-jellyfin-configure-libraries">Configure Libraries</h2>
<ol>
<li>
<p>Click "Add Media Library"
<br/> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/jellyfin/jellyfin-add-media-library.png"><img alt="jellyfin-add-media-library.png" src="../img/jellyfin/jellyfin-add-media-library.png" width="200"/></a></p>
</li>
<li>
<p>Choose "Content Type" -&gt; content type of your folder (likely 'Movies' or 'Shows')</p>
</li>
<li>Click + <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/jellyfin/jellyfin-addfolder.png"><img alt="jellyfin-addfolder.png" src="../img/jellyfin/jellyfin-addfolder.png" width="100"/></a></li>
<li>Add the folder that contains the specified Content Type files</li>
<li>Repeat for other libraries</li>
</ol>
<h2 id="server-apps-jellyfin-live-tv-configuration">Live TV Configuration</h2>
<details class="note">
<summary>(click to expand)</summary>
<h3 id="server-apps-jellyfin-static-ip-address">Static IP address:</h3>
<ol>
<li>
<p>Find HDHomeRun MAC address at <a href="http://hdhomerun.local/system.html">http://hdhomerun.local/system.html</a>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If this URL is not working, first locate the IP address of HDHomeRun on modem Web UI at <a href="http://192.168.0.1/modemstatus_landevicelist.html">http://192.168.0.1/modemstatus_landevicelist.html</a> and use the IP Address instead of <code>hdhomerun.local</code></p>
</div>
</li>
<li>
<p>In <a href="http://192.168.0.1/index.html">modem settings</a> -&gt; Advanced Setup -&gt; DHCP Reservation:<br>
Enter (or choose) the MAC address and set a static IP (whatever IP was already set on the HDHR system menu web page)</br></p>
</li>
</ol>
<h3 id="server-apps-jellyfin-setup-live-tv">Setup Live TV</h3>
<p>Follow the "Manual Setup" directions located at: 
<a href="https://jellyfin.org/docs/general/server/live-tv/setup-guide.html">https://jellyfin.org/docs/general/server/live-tv/setup-guide.html</a></p>
<p>To find the IP address of the HDHomeRun, go to the web UI at <a href="http://hdhomerun.local/system.html">http://hdhomerun.local/system.html</a></p>
<p>Once setup, change recording paths in Dashboard -&gt; DVR. Change these to folders on the external hard drive. If you wish to separate Movies and Shows, set a recording path. If you wish to group them all together, just specify a default recording path.</p>
<h3 id="server-apps-jellyfin-add-guide-data">Add Guide Data</h3>
<ol>
<li>
<p>Create an account at <a href="https://tvlistings.zap2it.com/">https://tvlistings.zap2it.com/</a> </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ensure that the password you use here is not used for ANYTHING else.</p>
<p>This password will be stored as a command line parameter in the Docker container. </p>
</div>
</li>
<li>
<p>Create a folder on the Mac: <code>/Users/Shared/xmltvdata</code></p>
</li>
<li>
<p>Install <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a> </p>
<ul>
<li>Settings -&gt; General -&gt; Start Docker Desktop when you log in</li>
<li>Settings -&gt; Resources -&gt; File Sharing: Remove existing mounts and add /Users/Shared/xmltvdata</li>
</ul>
</li>
<li>
<p>Create a Docker container for the <a href="https://github.com/shuaiscott/zap2xml">Zap2XML Docker Container</a></p>
<ul>
<li>Open Docker Desktop app</li>
<li>Run terminal command: replace <code>your_zap2it_email@email.com</code> and <code>your_zap2it_password</code> with your <a href="https://tvlistings.zap2it.com/">https://tvlistings.zap2it.com/</a> account details. </li>
</ul>
<div class="highlight"><pre><span></span><code>docker run --restart<span class="o">=</span>always -d --name zap2xml -v /Users/Shared/xmltvdata:/data -e <span class="nv">USERNAME</span><span class="o">=</span>your_zap2it_email@email.com -e <span class="nv">PASSWORD</span><span class="o">=</span>your_zap2it_password -e <span class="nv">OPT_ARGS</span><span class="o">=</span><span class="s2">"-I -D -Z 55303"</span> -e <span class="nv">XMLTV_FILENAME</span><span class="o">=</span>xmltv.xml shuaiscott/zap2xml
</code></pre></div>
<p>By default, new guide data will be fetched by this Docker container every 12 hours. Additional command line arguments can be added/changed. See details on GitHub - shuaiscott/zap2xml README.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If troubleshooting is required, and the container needs to be added again, ensure the container and images are deleted before recreating using <code>docker run</code> command</p>
</div>
</li>
<li>
<p>Open the container</p>
<ul>
<li>Cick on on <code>zap2xml</code> from the 'Containers' view</li>
<li>Click <code>Logs</code></li>
<li>Let the Container run. When complete, a status message will print like this:</li>
</ul>
<div class="highlight"><pre><span></span><code>Downloaded 1090062 bytes in 291 http requests using 2 sockets.
Writing XML file: /data/xmltv.xml
Completed in 167s (Parse: 164s) 81 stations, 7895 programs, 17063 scheduled.
Last run time: Fri Mar 11 04:12:49 UTC 2022
Will run in 43200 seconds
</code></pre></div>
</li>
<li>
<p>Verify File</p>
<p>In macOS Finder, verify that a xmltv.xml file was created at location <code>/Users/Shared/xmltvdata</code>. File should start with something like:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE tv SYSTEM "xmltv.dtd"&gt;</span>

<span class="nt">&lt;tv</span> <span class="na">source-info-url=</span><span class="s">"http://tvlistings.zap2it.com/"</span> <span class="na">source-info-name=</span><span class="s">"zap2it.com"</span> <span class="na">generator-info-name=</span><span class="s">"zap2xml"</span> <span class="na">generator-info-url=</span><span class="s">"zap2xml@gmail.com"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;channel</span> <span class="na">id=</span><span class="s">"I2.1.21634.zap2it.com"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;display-name&gt;</span>2.1 KTCADT<span class="nt">&lt;/display-name&gt;</span>
        <span class="nt">&lt;display-name&gt;</span>2.1<span class="nt">&lt;/display-name&gt;</span>
        <span class="nt">&lt;display-name&gt;</span>KTCADT<span class="nt">&lt;/display-name&gt;</span>
        <span class="nt">&lt;icon</span> <span class="na">src=</span><span class="s">"https://zap2it.tmsimg.com/h3/NowShowing/21634/s32356_h3_aa.png"</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>Scroll down past the <code>&lt;channel&gt;&lt;/channel&gt;</code> sections, and verify that there are <code>&lt;/programme&gt;&lt;/programme&gt;</code> tags, with contents similar to</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;programme</span> <span class="na">start=</span><span class="s">"20220311023000 +0000"</span> <span class="na">stop=</span><span class="s">"20220311040000 +0000"</span> <span class="na">channel=</span><span class="s">"I2.1.21634.zap2it.com"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>Endeavour: The Evolution<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;desc</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>A look at how …..<span class="nt">&lt;/desc&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>Documentary<span class="nt">&lt;/category&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>Special<span class="nt">&lt;/category&gt;</span>
        <span class="nt">&lt;length</span> <span class="na">units=</span><span class="s">"minutes"</span><span class="nt">&gt;</span>90<span class="nt">&lt;/length&gt;</span>
        <span class="nt">&lt;icon</span> <span class="na">src=</span><span class="s">"https://zap2it.tmsimg.com/assets/p21373423_b_v13_aa.jpg"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;url&gt;</span>https://tvlistings.zap2it.com//overview.html?programSeriesId=SH04161006<span class="ni">&amp;amp;</span>tmsId=SH041610060000<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;episode-num</span> <span class="na">system=</span><span class="s">"dd_progid"</span><span class="nt">&gt;</span>SH04161006.0000<span class="nt">&lt;/episode-num&gt;</span>
        <span class="nt">&lt;previously-shown</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;subtitles</span> <span class="na">type=</span><span class="s">"teletext"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/programme&gt;</span>
</code></pre></div>
</li>
<li>
<p>Once the file looks correct, it can be added into Jellyfin. </p>
</li>
</ol>
<p>Add the created file to Jellyfin from Administration Dashboard -&gt; Live TV -&gt; TV Guide Data Providers -&gt; XMLTV</p>
<p>See details on <a href="https://jellyfin.org/docs/general/server/live-tv/setup-guide.html#adding-guide-data">Adding Guide Data - Setup Guide | Documentation - Jellyfin Project</a></p>
</details>
<h3 id="server-apps-jellyfin-post-processing">Post Processing</h3>
<p>Jellyfin supports Post Processing of recorded Live TV shows. This can be used to transcode the recording to a specific format that does not require transcoding on the fly when playing back, extract subtitles, remove commercials, and more.</p>
<p>More details on post processing is available on <a href="https://jellyfin.org/docs/general/server/live-tv/post-process.html">Live TV Post Processing | Documentation - Jellyfin Project</a></p>
<h4 id="server-apps-jellyfin-prerequisites">Prerequisites</h4>
<p>Install using <a href="https://brew.sh">Brew</a>:</p>
<ul>
<li>Python</li>
<li>Python3</li>
<li>Pip</li>
<li>Pip3</li>
<li>ffmpeg
if using Slack notifications: slack_sdk</li>
</ul>
<h4 id="server-apps-jellyfin-create-scripts">Create Scripts</h4>
<ol>
<li>
<p>Create Folders:</p>
<ul>
<li><code>/Users/Shared/Scripts</code></li>
<li><code>/Users/Shared/Scripts/logs</code></li>
</ul>
</li>
<li>
<p>Create Files:</p>
<ul>
<li><code>/Users/Shared/Scripts/run_post_processor.sh</code></li>
<li><code>/Users/Shared/Scripts/record_post_process.py</code></li>
</ul>
</li>
<li>
<p>Edit Scripts:
    Use VSCode or another code editor to add code into these scripts. </p>
<p>Copy and paste from GitHub links:</p>
<ul>
<li><a href="https://gist.github.com/AndrewBreyen/0fc36c868486d48583a369b657e22c69">run_post_processor.sh</a></li>
<li><a href="https://gist.github.com/AndrewBreyen/1ac109bb485d8523e28fe98b3a222602">record_post_process.py</a></li>
</ul>
<p>In <code>run_post_processor.sh</code>:</p>
<ul>
<li>Change logging directory to /Users/Shared/Scripts</li>
<li>Change Python path to the result of <code>which python3</code></li>
<li>Change path of <code>record_post_process.py</code> to <code>/Users/Shared/Scripts/record_post_process.py</code></li>
</ul>
<p>In <code>record_post_process.py</code>:</p>
<ul>
<li>Change logging directory to <code>/Users/Shared/Scripts/logs</code></li>
<li>Add Slack token</li>
<li>If desired, change deleting non-transcoded file to keep original file and move</li>
</ul>
</li>
<li>
<p>Make shell script executable -- run in a terminal: 
<div class="highlight"><pre><span></span><code>chmod +x /Users/Shared/Scripts/run_post_processor.sh
</code></pre></div></p>
</li>
</ol>
<h4 id="server-apps-jellyfin-add-to-jellyfin">Add to Jellyfin</h4>
<ol>
<li>
<p>In Jellyfin Dashboard/DVR/Recording Post Processing settings:</p>
</li>
<li>
<p>Set "Post-processing application" to your shell script which calls your actual post processor (details of this 'actual' post processor script below). In this example, that would be <code>/Users/Shared/Scripts/run_post_processor.sh</code></p>
</li>
<li>
<p>Set "Post-processor command line arguments" to <code>"{path}"</code></p>
</li>
</ol>
<h4 id="server-apps-jellyfin-test-python-script">Test Python Script</h4>
<ol>
<li>
<p>Record a show from the Jellyfin Web UI (this recording can be just a few seconds long)</p>
</li>
<li>
<p>Troubleshoot by viewing logs at <code>/Users/Shared/Scripts/logs/*</code>. </p>
</li>
</ol></section><section class="print-page" id="server-apps-homebridge"><h1 id="server-apps-homebridge-homebridge">Homebridge</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Homebridge is used for Home Controls of Plugs, Garage Door.</p>
</div>
<h2 id="server-apps-homebridge-install-locally">Install locally</h2>
<p>Follow instrictions on the README of the <a href="https://github.com/homebridge/homebridge/wiki/Install-Homebridge-on-macOS">Homebridge Repo</a></p>
<p>Once installed, and hb-service has been ran:</p>
<p>In the Web UI:</p>
<ol>
<li>Click "Get Started"</li>
<li>Create an admin user and specify password</li>
<li>Click "Open Dashboard"</li>
</ol>
<h2 id="server-apps-homebridge-install-plugins">Install plugins</h2>
<p>Homebridge Tuya Platform <a href="https://github.com/tuya/tuya-homebridge">https://github.com/tuya/tuya-homebridge</a></p>
<h2 id="server-apps-homebridge-configure-homebridge-tuya-platform-plugin">Configure Homebridge Tuya Platform plugin</h2>
<ul>
<li>Name: TuyaPlatform</li>
<li>Username: andrew.breyen@gmail.com</li>
<li>Password: [REDACTED] -- password of Tuya account</li>
<li>Access ID: [REDACTED]</li>
<li>Access Key: [REDACTED]</li>
<li>Language Code: en</li>
<li>Project Type: PaaS</li>
<li>PaaS Platform: Smart Life</li>
<li>Country Code: 1</li>
</ul>
<h2 id="server-apps-homebridge-setup-and-configure">Setup and Configure</h2>
<p>Once the Homebridge Tuya Platform plugin is added, click the power icon on the top right to restart</p>
<p>Once back up, click <code>Accessories</code> and verify that all accessories have been added</p>
<p>Scan QR code from Status screen using Home App -&gt; Add Accessories</p>
<p>Add the bridge to room <code>ZAccessories</code>, continue setup within Home app, place accessories into correct rooms</p></section><section class="print-page" id="server-apps-scrypted"><h1 id="server-apps-scrypted-scrypted">Scrypted</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Scrypted is used to serve Video Camera Content to Apple Home.</p>
</div>
<h2 id="server-apps-scrypted-install-locally">Install locally</h2>
<p><a href="https://github.com/koush/scrypted/wiki/Installation:-Mac">https://github.com/koush/scrypted/wiki/Installation:-Mac</a></p>
<h2 id="server-apps-scrypted-install-plugins">Install plugins</h2>
<ul>
<li>HomeKit</li>
<li>RTSP Camera Plugin</li>
<li>Rebroadcast Plugin</li>
</ul>
<h2 id="server-apps-scrypted-configure-plugins">Configure plugins</h2>
<p>RTSP cameras</p>
<ul>
<li>Add 2 cameras (Front Porch, Backyard), username: wyzecam, Password: wyzecam, Snapshot URL: [blank], RTSP Stream URL: rtsp://wyzecam:wyzecam@[IP ADDR OF CAMERA]/live</li>
</ul>
<p>Homekit</p>
<ul>
<li>View console of plugin to see QR code, add accessory via iOS Home app. </li>
<li>Add the bridge to room ‘ZAccessories’, continue setup within Home app, place accessories into correct rooms</li>
</ul>
<h2 id="server-apps-scrypted-additional-plugins-used-by-scrypted">Additional plugins used by Scrypted</h2>
<p>OpenCV: <a href="https://opencv.org/">https://opencv.org/</a><br/>
Used to detect motion and send homekit notifications</p></section><section class="print-page" id="server-apps-node-red"><h1 id="server-apps-node-red-node-red">Node-RED</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Node-RED is used to control automations that require more settings/control than HomeKit or HomeBridge can provide natively. </p>
</div>
<div class="admonition quote">
<p class="admonition-title">
<p>Node-RED is a programming tool for wiring together hardware devices, APIs and online services in new and interesting ways.  </p>
<p>It provides a browser-based editor that makes it easy to wire together flows using the wide range of nodes in the palette that can be deployed to its runtime in a single-click."</p>
</p>
</div>
<h2 id="server-apps-node-red-installation">Installation</h2>
<!-- DIRECTIONS FOR DOCKER INSTALL -- unsuccessful -->
<!-- Prerequisites:
- Docker Desktop installed

1. Create folder `/Users/Shared/nodered_data`
2. Add the created folder as a shared resource in Docker settings -> Resources -> File Sharing 
2. In a terminal, run:
    <div class="highlight"><pre><span></span><code>docker run --restart=always -it -p 1880:1880 -v /Users/Shared/nodered_data:/data --name mynodered nodered/node-red
</code></pre></div>
3. Once you see a message from the terminal similar to
    <div class="highlight"><pre><span></span><code>Welcome to Node-RED
===================

2 Oct 23:26:06 - [info] Node-RED version: v3.0.2
2 Oct 23:26:06 - [info] Node.js  version: v16.16.0
...
2 Oct 23:26:07 - [info] Started flows
</code></pre></div>
    Node-RED has been successfully installed!
4. Open the web UI at  -->
<!-- LOCAL INSTALL -->
<p>Prerequisites:</p>
<ul>
<li>
<p>npm installed</p>
</li>
<li>
<p>Open a terminal and run <code>sudo npm install -g --unsafe-perm node-red</code></p>
</li>
<li>Once you see a message from the terminal similar to
    <div class="highlight"><pre><span></span><code>Welcome to Node-RED
===================

2 Oct 23:26:06 - [info] Node-RED version: v3.0.2
2 Oct 23:26:06 - [info] Node.js  version: v16.16.0
...
2 Oct 23:26:07 - [info] Started flows
</code></pre></div>
    Node-RED has been successfully installed!</li>
<li>Exit Node-RED by pressing <span class="keys"><kbd class="key-control">Ctrl</kbd></span> + <span class="keys"><kbd class="key-c">C</kbd></span> (will be restarted later using pm2 to run in the background)</li>
</ul>
<p>More information available at: <a href="https://nodered.org/docs/getting-started/local">https://nodered.org/docs/getting-started/local</a></p>
<h2 id="server-apps-node-red-enabling-node-red-to-start-on-computer-boot">Enabling Node-RED to start on computer boot</h2>
<ol>
<li>Install PM2: In a terminal, run: <code>sudo npm install -g pm2</code></li>
<li>Determine the exact location of the <code>node-red</code> command: run <code>which node-red</code> in a terminal</li>
<li>Tell PM2 to run Node-Red: run <code>pm2 start /path/to/node-red -- -v</code> in a terminal, replacing <code>/path/to/node-red</code> with the result of <code>which node-red</code> from above</li>
<li>Temm PM2 to run on boot: Run these commands in a terminal, and follow the instructions provided</li>
<li><code>pm2 save</code></li>
<li><code>pm2 startup</code></li>
<li>Reboot the machine, and verify that PM2 has started NodeRED </li>
</ol>
<p>More information: <a href="https://nodered.org/docs/faq/starting-node-red-on-boot">https://nodered.org/docs/faq/starting-node-red-on-boot</a></p>
<h2 id="server-apps-node-red-additional-palette-items">Additional Palette items</h2>
<p>Once Node-RED is running and you can access via a web browser, install these additional items by clicking the three lines hamburger button in the top right, and selecting ‘Manage Palette’, then move to the ‘Install’ tab</p>
<ul>
<li>node-red</li>
<li>node-red-contrib-cron</li>
<li>node-red-contrib-homebridge-automation</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure the correct Palette item is chosen -- there are two versions available</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/node-red/node-red-homebridge-two-versions.png"><img alt="node-red-homebridge-two-versions.png" src="../img/node-red/node-red-homebridge-two-versions.png" width="200"/></a></p>
</div>
<ul>
<li>node-red-contrib-slack-files</li>
<li>node-red-contrib-stoptimer</li>
</ul>
<h2 id="server-apps-node-red-importing-flows">Importing Flows</h2>
<ol>
<li>Go to <a href="https://github.com/AndrewBreyen/Node-RED-flows/">https://github.com/AndrewBreyen/Node-RED-flows/</a> and pick which flow you want to start importing</li>
<li>Copy the contents of desired flows’ (use the <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/node-red/node-red-copy-paste-squares.png"><img alt="node-red-copy-paste-squares.png" src="../img/node-red/node-red-copy-paste-squares.png" style="height:30px;width:25px"/></a> button for ease of use)</li>
<li>Click the three lines hamburger button in the top right, and selecting ‘Import’</li>
<li>Paste in value copied to clipboard</li>
<li>Go to <a href="https://api.slack.com/apps/A03JPNEBPC4/incoming-webhooks">https://api.slack.com/apps/A03JPNEBPC4/incoming-webhooks</a> to retrieve the Webhook URL, copy to clipboard</li>
<li>Double click on the <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/node-red/node-red-slack-node.png"><img alt="node-red-copy-paste-squares.png" src="../img/node-red/node-red-slack-node.png" style="height:40px;width:100px"/></a> node(s)</li>
<li>Paste in the Webhook URL copied to clipboard</li>
<li>Double click on the <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/node-red/node-red-garage-door-node-1.png"><img alt="node-red-garage-door-node-1.png" src="../img/node-red/node-red-garage-door-node-1.png" style="height:40px;width:200px"/></a> and <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/node-red/node-red-garage-door-node-2.png"><img alt="node-red-garage-door-node-2.png" src="../img/node-red/node-red-garage-door-node-2.png" style="height:40px;width:200px"/></a>nodes, ensure that the correct device and Homebridge Pin are selected</li>
<li>Repeat with the other flows you want to import</li>
<li>Test it out!</li>
</ol></section><section class="print-page" id="server-apps-pihole"><h1 id="server-apps-pihole-pihole">Pihole</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Pihole is used as a network wide Ad blocker using DNS.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are two ways to install PiHole.</p>
<ul>
<li>If installing from scratch, go to <a href="#server-apps-pihole-set-up-from-scratch">Set Up From Scratch</a> section</li>
<li>If installing from a precreated .OVA Virtual Machine file, go to the <a href="#server-apps-pihole-set-up-from-virtual-machine-file">Set Up From Virtual Machine File</a> section</li>
</ul>
</div>
<h2 id="server-apps-pihole-set-up-from-scratch">Set Up From Scratch</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use these directions if setting up from scratch</p>
</div>
<p>Create a VM using VirtualBox. </p>
<p>See <a href="#server-apps-create-vm">Create VM</a> for details. </p>
<h3 id="server-apps-pihole-install-pihole">Install PiHole</h3>
<ul>
<li>RUN in terminal of PiHole VM:
<div class="highlight"><pre><span></span><code>curl -sSL https://install.pi-hole.net <span class="p">|</span> bash
</code></pre></div>
More details on installation can be found at <a href="https://github.com/pi-hole/pi-hole/#curl--ssl-httpsinstallpi-holenet--bash">https://github.com/pi-hole/pi-hole/#curl--ssl-httpsinstallpi-holenet--bash</a></li>
<li>When you get to the blue "GUI" screen:<ul>
<li>Majorly accept default settings. Read through and change as you wish.</li>
<li>When prompted for 'Upstream DNS Provider;, select which one you want. They all pretty much do the same thing. Recommendation: OpenDNS</li>
<li>Install the suggested block lists (usually 'StevenBlack's Unified Hosts List' is the default)</li>
<li>Install the Admin Web Interface, lighttpd and required PHP modules</li>
<li>Enable Query logging if you wish</li>
</ul>
</li>
<li>Once installation is complete, note the 'Admin Webpage Login Password' -- The password cannot be retrieved later on, but it is possible to set a new password (or explicitly disable the password by setting an empty password)</li>
</ul>
<!---
*****
***** These directions were for when modem was handling DHCP, this has been shifted to the eeros
*****
1. Open modem web UI [192.168.0.1](192.168.0.1/)
2. Advanced Setup -> DHCP Settings -> 5. Set the DNS servers allocated with DHCP requests
3. Change radio button to `Custom Servers`
4. Enter VM IP address as 'Primary DNS', and Open DNS backup server (8.8.4.4) as 'Secondary DNS'

    ![vmodem-custom-dns-servers.png](../img/modem-web-ui/modem-custom-dns-servers.png){ width="500"}

5. Click `Apply`
--->
<h3 id="server-apps-pihole-finalize-setup">Finalize Setup</h3>
<p>Regardless if setting up PiHole from scratch, or from a Virtual Machine File, some final configuration/verification is required. </p>
<p>Continue to <a href="#server-apps-pihole-set-the-vm-to-auto-launch-in-headless-mode-on-mac-login">Set the VM to auto-launch in headless mode on Mac login</a></p>
<h2 id="server-apps-pihole-set-up-from-virtual-machine-file">Set Up From Virtual Machine File</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use these directions if setting up PiHole from a Virtual Machine .OVA file</p>
</div>
<h3 id="server-apps-pihole-virtualbox-installation-and-importing-applicance">Virtualbox Installation and Importing Applicance</h3>
<ol>
<li>Download and install Virtualbox from <a href="https://www.virtualbox.org">https://www.virtualbox.org</a></li>
<li>
<p>Download OVA file from <a href="https://1drv.ms/u/s!Ai9VHivOqpbhjzuzVWtlc2ctYijh?e=QS0j5c">OneDrive</a></p>
<p>(Access to this link is restricted -- please confirm if you have access)</p>
</li>
<li>
<p>Open Virtualbox and click 'Import'
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/pihole/virtualbox-import.png"><img alt="virtualbox-import.png" src="../img/pihole/virtualbox-import.png" width="40"/></a></p>
</li>
<li>Click the folder icon next to the 'File' box and pick the .OVA file</li>
<li>Click 'Continue'</li>
<li>Appliance Settings: Change 'MAC Address Policy' to Include all network adapter MAC addresses. Leave all other settings the same. Click 'Import'</li>
</ol>
<h3 id="server-apps-pihole-verify-settings">Verify Settings</h3>
<ol>
<li>Once the Applicance is imported, verify that the settings match the ones <a href="#server-apps-pihole-change-vm-settings">outlined above</a></li>
<li>Ensure the correct IP address is reserved in the eero app. Details <a href="#server-apps-pihole-set-ip-address-reservation">outlined above</a></li>
</ol>
<h3 id="server-apps-pihole-start-up">Start Up</h3>
<ol>
<li>Start VM in headless mode (click arrow next to start -&gt; headless mode) <br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/pihole/virtualbox-start-headless.png"><img alt="virtualbox-start-headless.png" src="../img/pihole/virtualbox-start-headless.png" width="75"/></a></li>
<li>Click 'Show'</li>
</ol>
<h3 id="server-apps-pihole-verify-connectivity">Verify Connectivity</h3>
<ol>
<li>
<p>Verify internet connectivity by entering command <code>ping google.com</code>. If you see a response similar to:
    <div class="highlight"><pre><span></span><code>64 bytes from 142.250.191.238: icmp_seq=93 ttl=57 time=42.931 ms
</code></pre></div>
    the VM can reach the internet.</p>
<p>Press <span class="keys"><kbd class="key-control">Ctrl</kbd></span> + <span class="keys"><kbd class="key-c">C</kbd></span> to exit.</p>
</li>
<li>
<p>Verify IP Address by entering command <code>ip addr</code>. Look at the result for the <code>inet 192.168.4.x</code> line. It should be the IP address specified in the eero reservation. 
    <div class="highlight"><pre><span></span><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
....
2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
link/ether 08:00:27:1a:f8:19 brd ff:ff:ff:ff:ff:ff
<span class="hll">inet 192.168.4.4/22 metric 100 brd 192.168.7.255 scope global dynamic enp0s3
</span>   valid_lft 14039sec preferred_lft 14039sec
....
</code></pre></div></p>
</li>
</ol>
<h3 id="server-apps-pihole-finalize-setup_1">Finalize Setup</h3>
<p>Regardless if setting up PiHole from scratch, or from a Virtual Machine File, some final configuration/verification is required. </p>
<p>Continue to <a href="#server-apps-pihole-set-the-vm-to-auto-launch-in-headless-mode-on-mac-login">Set the VM to auto-launch in headless mode on Mac login</a></p>
<h2 id="server-apps-pihole-set-the-vm-to-auto-launch-in-headless-mode-on-mac-login">Set the VM to auto-launch in headless mode on Mac login</h2>
<p>Download the script vboxlaunchagent.sh from 
<a href="https://www.whatroute.net/software/vboxlaunchagent.sh.zip">https://www.whatroute.net/software/vboxlaunchagent.sh.zip</a></p>
<p>Move the downloaded file somewhere convenient, like the Desktop. </p>
<div class="admonition quote">
<p class="admonition-title">whatroute.net</p>
<p>LaunchAgents are configured with an Apple plist XML file installed in the users Library/LaunchAgents folder. When the user logs in to their account on the Mac, launchd will inspect these plist files and invoke the required program with specified arguments.</p>
<p>It can get a bit tricky to create a plist manually. They have very fussy and very unforgiving syntax requirements. This shell script will create the plist and install it in the LaunchAgents directory.</p>
<p>You can download the script from vboxlaunchagent.sh. Unzip the file and copy the script to a suitable directory on your machine.</p>
</div>
<p>Run the script using this syntax:</p>
<ol>
<li>
<p>Find the name of the VM: In a terminal on MacServer directly (not the VM), run:
   <div class="highlight"><pre><span></span><code>VBoxManage list vms
</code></pre></div></p>
<p>Should result in output similar to:<br>
<div class="highlight"><pre><span></span><code>macmini@macserver ~ % VBoxManage list vms
<span class="s2">"Pihole"</span> <span class="o">{</span>c7ac734f-3fc7-4645-997b-3c78ef32d8f4<span class="o">}</span>
</code></pre></div></br></p>
<p>In this example, Pihole is the name of the VM.</p>
</li>
<li>
<p>In a terminal, run
   <div class="highlight"><pre><span></span><code>sh path/to/vboxlaunchagent.sh --headless --verbose <span class="s2">"VMName"</span>
</code></pre></div>
   replacing <code>VMName</code> with the name of the VM from the previous step, and <code>/path/to/vboxlaunchagent.sh</code> with the full path (likely will be <code>~/Downloads/vboxlaunchagent.sh</code> if you just clicked the link above)</p>
</li>
<li>
<p>Ensure that the output is similar to
    <div class="highlight"><pre><span></span><code>VirtualBox VM found. . . : PiHole
Created temporary file . : /tmp/org.virtualbox.launch.PiHole
Created Launch Agent . . : /Users/macmini/Library/LaunchAgents/org.virtualbox.launch.PiHole.plist
</code></pre></div></p>
</li>
<li>
<p>Reboot the Mac and ensure the VM auto-starts on login</p>
</li>
</ol>
<p>(Script and explanation from <a href="https://www.whatroute.net/installerapp2iso.html">https://www.whatroute.net/installerapp2iso.html</a>)</p>
<h2 id="server-apps-pihole-configure-pihole">Configure PiHole</h2>
<ul>
<li>Remove or change admin web page password: RUN in terminal of PiHole VM:
<div class="highlight"><pre><span></span><code>sudo pihole -a -p
</code></pre></div></li>
<li>Open the Web UI (http://your.static.ip.address/admin)</li>
<li>Configure as you wish</li>
</ul>
<h2 id="server-apps-pihole-set-dhcp-server">Set DHCP Server</h2>
<ol>
<li>Open the eero app</li>
<li>Go to Settings -&gt; Network Settings -&gt; DNS</li>
<li>Set to 'Custom'</li>
<li>Set 'IPv4 Primary' to the static IP address of PiHole</li>
<li>Set 'IPv4 Secondary' to a backup DNS provider to use.</li>
</ol>
<details class="info">
<summary>Available Providers</summary>
<p>Usually it's a good idea to use the same DNS provider that you selected during PiHole setup. However, this is not required.</p>
<p>Some available providers:</p>
<ul>
<li>OpenDNS: 208.67.222.222</li>
<li>Google: 8.8.8.8</li>
<li>CloudFlare: 1.1.1.1</li>
</ul>
</details>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You can choose to not supply a secondary provider to force PiHole to be used exclusively.</p>
<p>However, if a secondary DNS provider is not set, if PiHole is down or unavailable to reqpond to queries, DNS queries will not be able to be resolved, resulting in no internet access. </p>
</div>
<p><br/><br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/emotes/parrot.gif"><img alt="parrot.gif" src="../img/emotes/parrot.gif"/></a>
Once the DNS server is set, Congrats! Pihole is now in use for all devices on the network.
You can test PiHole by visiting a website that previously had ads, they should be blocked now :)</p>
<h2 id="server-apps-pihole-troubleshooting-sites-not-loading">Troubleshooting Sites not Loading</h2>
<p>Pihole is a tracking and ad-blocker. Because of this, some sites may not load, or be missing content. </p>
<h3 id="server-apps-pihole-temporarily-disable-pihole">Temporarily Disable Pihole</h3>
<p>If this is a one-off thing that you need to load, you can temporarily disable Pihole across the whole network. </p>
<ol>
<li>Open the <a href="http://192.168.4.4/admin">PiHole Web UI</a></li>
<li>Click 'Disable'</li>
<li>Choose an amount of time to disable. 5 minutes is usually sufficent. </li>
</ol>
<p>PiHole is now disabled, and will be automatically re-enabled once the time elapses.</p>
<h3 id="server-apps-pihole-add-a-site-to-the-whitelist">Add a site to the whitelist</h3>
<ol>
<li>Open the <a href="http://192.168.4.4/admin">PiHole Web UI</a></li>
<li>Click 'Whitelist'</li>
<li>
<p>Type the domain where you are encountering issues in the 'Domain' field. </p>
<p>Add any comments as needed</p>
</li>
<li>
<p>Check the 'Add domain as wildcard' box</p>
</li>
<li>Click 'Add to Whitelist'</li>
</ol>
<h3 id="server-apps-pihole-use-the-audit-log">Use the Audit Log</h3>
<p>Audit Log will show the top allowed and blocked queries with quick access to blacklist or whitelist them</p>
<ol>
<li>Open the <a href="http://192.168.0.4/admin">PiHole Web UI</a></li>
<li>Click 'Tools' -&gt; 'Audit Log'</li>
</ol>
<h2 id="server-apps-pihole-updating-pihole-pihole-and-underlying-ubuntu-os">Updating Pihole (Pihole and underlying Ubuntu OS)</h2>
<p>If you see red text at the bottom of the PiHole web UI ‘Update Available’, it needs an update. This is currently a manual process, work in progress to automate it. There are two options, both do exactly the same thing. The SSH option may be easier. </p>
<h3 id="server-apps-pihole-via-ssh">Via SSH</h3>
<h4 id="server-apps-pihole-pihole-updates">Pihole Updates</h4>
<ol>
<li>
<p>Open a Terminal and enter command: <code>ssh pihole@pi.hole</code><br>
    If you get a message similar to:<br>
<div class="highlight"><pre><span></span><code>The authenticity of host 'pi.hole (192.168.0.4)' can't be established.
ED25519 key fingerprint is SHA256:jWxxjslC9ObhMty4d0UNERghKP6UWmetfEj80CKW6QY.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:8: 192.168.0.4
Are you sure you want to continue connecting (yes/no/[fingerprint])?
</code></pre></div></br></br></p>
<p>This is likely because you have not connected to the PiHole VM using SSH previously, and your computer cannot verify the authenticity of the server computer.</p>
<p>Verify the IP address is what you expect (in this example, <code>192.168.0.4</code>) and if it’s correct, type <code>yes</code> at the prompt. </p>
<p>After you have sone this once, you likely will not have to do it again, unless the fingerprint key changes. </p>
</li>
<li>
<p>At the prompt <code>pihole@pi.hole's password:</code> enter the PiHole user password. Once successfully connected, you should see a prompt similar to <code>pihole@pihole:~$</code>. You are now SSHed into the PiHole VM!</p>
</li>
<li>
<p>Run command
   <div class="highlight"><pre><span></span><code>pihole -up
</code></pre></div></p>
</li>
<li>If prompted <code>[sudo] password for pihole:</code>  enter the PiHole user password  </li>
<li>Wait for it to update. On success, you should see   <code>[✓] Everything is up to date!</code></li>
</ol>
<h4 id="server-apps-pihole-ubuntu-updates">Ubuntu Updates</h4>
<p>It’s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 
<div class="highlight"><pre><span></span><code>91 updates can be applied immediately.
9 of these updates are standard security updates.
</code></pre></div></p>
<p>To do this:</p>
<ol>
<li>Run <code>sudo apt upgrade</code></li>
<li>
<p>You may be prompted:
<div class="highlight"><pre><span></span><code>After this operation, 430 MB of additional disk space will be used.
Do you want to continue? [Y/n]
</code></pre></div>
Enter <span class="keys"><kbd class="key-y">Y</kbd></span></p>
</li>
<li>
<p>Wait for it to update. This may take a while, depending on the number of updates.</p>
</li>
</ol>
<h3 id="server-apps-pihole-via-apple-remote-desktop">Via Apple Remote Desktop</h3>
<h4 id="server-apps-pihole-pihole-updates_1">Pihole Updates</h4>
<ol>
<li>Open Apple Remote Desktop</li>
<li>Select <code>MacServer</code> from All Computers</li>
<li>Click on <code>Control</code> or from the taskbar, or choose <code>Interact &gt; Control</code> </li>
<li>A new window will open with the MacServer display. </li>
<li>From the Dock, Applications Folder or Spotlight, open <code>VirtualBox</code></li>
<li>Ensure <code>Pihole</code> is selected in the sidebar<br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/pihole/virtualbox-pihole-running.png"><img alt="virtualbox-pihole-running.png" src="../img/pihole/virtualbox-pihole-running.png" width="200"/></a></li>
<li>Click <code>Show</code> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/pihole/virtualbox-show.png"><img alt="virtualbox-pihole-running.png" src="../img/pihole/virtualbox-show.png" width="40"/></a></li>
<li>A new window will open with the PiHole VM. </li>
<li>In that new window, ensure you have a <code>pihole@pihole:~$</code> prompt. If you do not, press <span class="keys"><kbd class="key-enter">Enter</kbd></span> a few times to get to a new line. </li>
<li>Run command
    <div class="highlight"><pre><span></span><code>pihole -up
</code></pre></div></li>
<li>If prompted <code>[sudo] password for pihole:</code>  enter the PiHole user password</li>
<li>Wait for it to update. On success, you should see   <code>[✓] Everything is up to date!</code></li>
</ol>
<h4 id="server-apps-pihole-ubuntu-updates_1">Ubuntu Updates</h4>
<p>It’s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 
<div class="highlight"><pre><span></span><code>91 updates can be applied immediately.
9 of these updates are standard security updates.
</code></pre></div></p>
<p>To do this:</p>
<ol>
<li>Run 
   <div class="highlight"><pre><span></span><code>sudo apt upgrade
</code></pre></div></li>
<li>
<p>You may be prompted:
<div class="highlight"><pre><span></span><code>After this operation, 430 MB of additional disk space will be used.
Do you want to continue? [Y/n]
</code></pre></div>
Enter <span class="keys"><kbd class="key-y">Y</kbd></span></p>
</li>
<li>
<p>Wait for it to update. This may take a while, depending on the number of updates.</p>
</li>
</ol></section><section class="print-page" id="server-apps-tdarr"><h1 id="server-apps-tdarr-tdarr">Tdarr</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Tdarr is used to transcode media files to a preferred format.</p>
</div>
<div class="admonition bug">
<p>Tdarr is not currently implemented.</p>
</div>
<h2 id="server-apps-tdarr-download">Download</h2>
<ol>
<li>Download Tdarr_Updater from <a href="https://docs.tdarr.io/docs/installation/windows-linux-macos">https://docs.tdarr.io/docs/installation/windows-linux-macos</a></li>
<li>Unzip downloaded file</li>
<li>Run <code>chmod +x /path/to/Tdarr_Updater</code> in a terminal</li>
<li>Run <code>/path/to/Tdarr_Updater</code></li>
<li></li>
</ol></section><section class="print-page" id="server-apps-timemachine-editor"><h1 id="server-apps-timemachine-editor-time-machine-editor">Time Machine Editor</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Time Machine Editor is used to modify the backup frequency of Time Machine Backups</p>
<p>This allows for space savings, as hourly snapshots are not saved, as well as performance benefits as a backup is not being created hourly.</p>
</div>
<p>Hourly backups are likely overkill for MacServer, so this is changed using Time Machine Editor. </p>
<p>Download and install from <a href="https://tclementdev.com/timemachineeditor/">https://tclementdev.com/timemachineeditor/</a></p>
<p>Open the installed application from the Applications Folder and change backup frequency. </p>
<p>Currently, this is set to backup on an interval of every 1 day.</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/timemachine-editor/timemachine-editor.png"><img alt="timemachine-editor.png" src="../img/timemachine-editor/timemachine-editor.png" width="300"/></a></p>
<p>To allow these settings to take effect, instead of the default macOS settings, ensure that 'Back Up Automatically' checkbox in System Prefrences -&gt; Time Machine is disabled. </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/timemachine-editor/timemachine-backupautomatically.png"><img alt="timemachine-backupautomatically.png" src="../img/timemachine-editor/timemachine-backupautomatically.png" width="300"/></a></p></section><h1 class='nav-section-title-end'>Ended: Server Apps</h1>
                        <h1 class='nav-section-title' id='section-hardware'>
                            Hardware <a class='headerlink' href='#section-hardware' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="hardware-hardware"><h1 id="hardware-hardware-hardware">Hardware</h1>
<h2 id="hardware-hardware-mac">Mac</h2>
<ul>
<li>Mac mini (2018)</li>
<li>Processor: 3.6 GHz Quad-Core Intel Core i3</li>
<li>Memory: 8 GB 2667 MHz DDR4</li>
<li>Graphics: Intel UHD Graphics 630 1536 MB</li>
</ul>
<h2 id="hardware-hardware-smart-devices">Smart Devices</h2>
<ul>
<li>ConBee II The Universal Zigbee USB Gateway</li>
</ul></section><section class="print-page" id="hardware-zigbee-conbee"><h1 id="hardware-zigbee-conbee-zigbee-conbee">Zigbee-Conbee</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Install deCONZ on a Pi</p>
</div>
<h2 id="hardware-zigbee-conbee-installing-conbee-on-pi">Installing Conbee on Pi</h2>
<ol>
<li>Download the latest SD Card image of the <code>Raspbian Buster Headless</code> version from <a href="https://www.phoscon.de/en/conbee2/sdcard">https://www.phoscon.de/en/conbee2/sdcard</a></li>
<li>Flash SD Card using Balena Etcher</li>
<li>Plug Pi into eero</li>
<li>Find IP address of Pi using eero app</li>
<li></li>
</ol></section><h1 class='nav-section-title-end'>Ended: Hardware</h1>
                        <h1 class='nav-section-title' id='section-troubleshooting'>
                            Troubleshooting <a class='headerlink' href='#section-troubleshooting' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="troubleshooting-reboot"><h1 id="troubleshooting-reboot-reboot">Reboot</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Most issues can be solved by rebooting the Mac.</p>
<p>If configured correctly, the mac should auto-login and all services should auto-start upon boot. </p>
</div>
<p>To reboot the machine, there are a couple different ways:</p>
<h3 id="troubleshooting-reboot-apple-remote-desktop-ard">Apple Remote Desktop (ARD)</h3>
<ol>
<li>Open ARD</li>
<li>Select ‘MacServer’ in the list</li>
<li>Choose Manage -&gt; Restart</li>
<li>Select ‘Users lose unsaved changes’</li>
<li>Click Restart</li>
<li>After the Mac has restarted, ‘Current Status’ should change to ‘Available’.</li>
<li>Verify that the Mac has all services back up and running -- they should all start automatically after a reboot</li>
</ol>
<h3 id="troubleshooting-reboot-ssh">SSH</h3>
<p>Use Terminal on a Mac, or “Termius” iOS app</p>
<ol>
<li>
<p>Connect to MacServer over ssh:</p>
<ol>
<li>
<p>In a terminal: 
    <div class="highlight"><pre><span></span><code>ssh macmini@macserver.local
</code></pre></div></p>
<p>You may recieve a message similar to
<div class="highlight"><pre><span></span><code>The authenticity of host 'macserver.local (192.168.0.2)' can't be established.
ED25519 key fingerprint is SHA256:f5c24jmfOO7dvFsdfsdf33SDFyzV1paytRg.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? 
</code></pre></div></p>
<p>This is likely because you have not connected to MacServer using SSH previously, and your computer cannot verify the authenticity of the server computer.</p>
<p>Verify the IP address is what you expect (in this example, <code>192.168.0.2</code>) and if it’s correct, type <code>yes</code> at the prompt. </p>
<p>After you have sone this once, you likely will not have ot do it again, unless the fingerprint key changes. </p>
</li>
<li>
<p>At prompt: <code>(macmini@macserver.local) Password:</code> enter MacMini user password (no characters will be shown when typed)</p>
</li>
<li>Connection success if prompt changes to <code>macserver:~ macmini$</code></li>
</ol>
</li>
<li>
<p>Enter
   <div class="highlight"><pre><span></span><code>sudo shutdown -r now
</code></pre></div>
   at the prompt</p>
</li>
<li>Enter <code>macmini</code> user password</li>
<li>Final shutdown message will be shown:<br/>
<div class="highlight"><pre><span></span><code>Shutdown NOW!

*** FINAL System shutdown message from macmini@macserver.local ***           
System going down IMMEDIATELY



System shutdown time has arrived
Connection to macserver.local closed by remote host.
Connection to macserver.local closed.
</code></pre></div></li>
<li>Connection should be closed automatically, verify that MacServer comes back up.</li>
</ol></section><section class="print-page" id="troubleshooting-live-tv-data-issues"><h1 id="troubleshooting-live-tv-data-issues-live-tv-guide-data-not-up-to-date">Live TV Guide Data not up to date</h1>
<h2 id="troubleshooting-live-tv-data-issues-use-remote-desktop-to-connect-to-the-computer">Use Remote Desktop to connect to the computer:</h2>
<ol>
<li>Open Apple Remote Desktop (ARD)</li>
<li>Select ‘MacServer’ in the list</li>
<li>
<p>Choose Interact -&gt; Control</p>
</li>
<li>
<p>Ensure that the Docker Container is healthy and running</p>
</li>
<li>
<p>Open Docker Desktop Dashboard by cliching the whale/container ship icon in the taskbar and choosing 'Dashboard'</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/docker/docker-desktop-dashboard.png"><img alt="docker-desktop-dashboard.png" src="../img/troubleshooting/docker/docker-desktop-dashboard.png" width="200"/></a></p>
<ol>
<li>Click on 'zap2xml'</li>
<li>
<p>Ensure there are logs either being streamed:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/docker/zap2xml-logs-parsing.png"><img alt="docker-desktop-dashboard.png" src="../img/troubleshooting/docker/zap2xml-logs-parsing.png" width="150"/></a></p>
<p>or you see the completed message:
<div class="highlight"><pre><span></span><code>Downloaded 1090062 bytes in 291 http requests using 2 sockets.
Writing XML file: /data/xmltv.xml
Completed in 167s (Parse: 164s) 81 stations, 7895 programs, 17063 scheduled.
Last run time: Fri Mar 11 04:12:49 UTC 2022
Will run in 43200 seconds
</code></pre></div></p>
</li>
<li>
<p>Restart the container<br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/docker/docker-desktop-restart.png"><img alt="docker-desktop-restart.png" src="../img/troubleshooting/docker/docker-desktop-restart.png" width="75"/></a> </p>
</li>
<li>If the container will not run, delete and recreate the Container per <a href="#server-apps-jellyfin-live-tv-configuration">Live TV Configuration</a> setup instructions</li>
</ol>
</li>
</ol>
<h2 id="troubleshooting-live-tv-data-issues-if-container-is-setup-running-and-healthy">If container is setup, running, and healthy:</h2>
<ol>
<li>
<p>Open the file <code>/Users/Shared/xmltvdata/xmltv.xml</code> with a text editor (preferrably Atom or Visual Studio Code) and see if the file has up to date data.</p>
<ol>
<li>Find the start of the <code>&lt;programme&gt;&lt;/programme&gt;</code> block (around line 500), and see that it has data similar to
<div class="highlight"><pre><span></span><code><span class="nt">&lt;programme</span> <span class="na">start=</span><span class="s">"YYYYMMDD090000 +0000"</span> <span class="na">stop=</span><span class="s">"YYYYMMDD100000 +0000"</span> <span class="na">channel=</span><span class="s">"I2.1.21634.zap2it.com"</span><span class="nt">&gt;</span> 
</code></pre></div>
Note the <code>YYYMMDD</code> in <code>start=</code> and <code>stop=</code>, these should be todays date (or very close to it)</li>
</ol>
</li>
<li>
<p>If the file does have up to date data but Jellyfin does not have updated data:
Open Jellyfin Admin Dashboard (web console) -&gt; Live TV and ensure file is listed under <code>TV Guide Data Providers</code><br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/jellyfin/jellyfin-tv-guide-data-providers.png"><img alt="jellyfin-tv-guide-data-providers.png" src="../img/troubleshooting/jellyfin/jellyfin-tv-guide-data-providers.png" width="500"/></a></p>
</li>
<li>
<p>If the file is listed:
Ensure that the Scheduled Task Live TV / Refresh Guide has run recently, and is scheduled to run every 12 hours<br/>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/jellyfin/jellyfin-scheduled-task-refresh-guide.png"><img alt="jellyfin-scheduled-task-refresh-guide.png" src="../img/troubleshooting/jellyfin/jellyfin-scheduled-task-refresh-guide.png" width="500"/></a>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/jellyfin/jellyfin-scheduled-task-refresh-guide-triggers.png"><img alt="jellyfin-scheduled-task-refresh-guide-triggers.png" src="../img/troubleshooting/jellyfin/jellyfin-scheduled-task-refresh-guide-triggers.png" width="500"/></a></p>
</li>
</ol></section><section class="print-page" id="troubleshooting-no-response-homekit"><h1 id="troubleshooting-no-response-homekit-smart-devices-showing-as-no-responseorange-exclamation-mark-in-apple-home">Smart Devices showing as “No Response”/Orange Exclamation mark in Apple Home</h1>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/troubleshooting/ios-exclamation-mark-not-available.png"><img alt="jellyfin-tv-guide-data-providers.png" src="../img/troubleshooting/ios-exclamation-mark-not-available.png" style="height:150px;width:300px"/></a></p>
<p>This is usually caused by your device, not MacServer. Try rebooting your device. </p>
<p>If it still shows an issue, check that HomeBridge/Scrypted are online and aren’t throwing any errors. </p>
<p>If issues persist, <a href="#troubleshooting-reboot">Reboot MacServer</a></p></section><section class="print-page" id="troubleshooting-network-change-smart-home"><h1 id="troubleshooting-network-change-smart-home-network-change-smart-home-devices">Network Change: Smart Home Devices</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>When the network is changed, some devices aren't smart enough to automatically reconnect to the new network. </p>
<p>To fix this, the devices need to be re-connected to the network.  </p>
</div>
<h3 id="troubleshooting-network-change-smart-home-smart-plugsgarage-door">Smart Plugs/Garage Door</h3>
<ol>
<li>Verify that accessories are offline. <ul>
<li>These devices should be blinking blue or red, and show offline in the Smart Life app</li>
</ul>
</li>
<li>Press and hold the button till the device blinks quickly. Wait a few seconds after blinking quickly, then press and hold the button till it blinks slowly. (AP Mode) </li>
<li>Follow the instructions in Smart Life app to add a new device.</li>
<li>Ensure that HomeBridge can control the newly added accessory. This may require removing cached accessories (three dots -&gt; Homebridge Settings -&gt; Remove All Cached Accessories)</li>
</ol>
<h3 id="troubleshooting-network-change-smart-home-cameraswyze-hub">Cameras/Wyze Hub</h3>
<ol>
<li>
<p>Verify that cameras are offline. </p>
<ul>
<li>The cameras should be blinking blue and red, the hub should be quickly blinking blue, and show offline in the Wyze app</li>
</ul>
</li>
<li>
<p>Follow instructions to add new camera/hub in Wyze app</p>
</li>
<li>The devices should respect their IP address reservations. Double check the IP of the device.</li>
</ol>
<p>If there are connection issues, temporarily disable 5GHz through the eero app (Settings -&gt; Troubleshooting -&gt; My device won't connect)</p></section><section class="print-page" id="troubleshooting-ventura-update"><h1 id="troubleshooting-ventura-update-macos-ventura-update-issues-and-solutions">macOS Ventura Update: Issues and Solutions</h1>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>macOS Ventura is Apple's latest macOS Operating System. </p>
<p>This page details issues encountered, and how to solve them  </p>
</div>
<h2 id="troubleshooting-ventura-update-virtualbox-aborted-with-exit-code-1">Virtualbox Aborted with Exit Code 1</h2>
<p>Error Text:
<div class="highlight"><pre><span></span><code>Failed to open a session for the virtual machine PiHole.

The virtual machine 'PiHole' has terminated unexpectedly during startup with exit code 1 (0x1).

Result Code: NS_ERROR_FAILURE (0x80004005)
Component: MachineWrap
</code></pre></div></p>
<p>Solution 1: 
VirtualBox 7 was recently released (Oct 10, updated Oct 20), which is MUCH better than version 6</p>
<p>Download latest version from <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>
<p>Use the uninstaller first, then install version 7. </p>
<p>The PiHole VM may need to be re-added. Attempt to re-add. If issues persist, try solution 2. </p>
<p>Solution 2: </p>
<ol>
<li>Open Terminal</li>
<li>Enter commands:
<div class="highlight"><pre><span></span><code>sudo su
csrutil clear
reboot
</code></pre></div></li>
<li>Verify if the issue persists by attempting to re-start the VM in headless mode. If it does not, stop troubleshooting. Otherwise, continue. </li>
<li>Download the latest release from <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a> and use <code>VirtualBox_Uninstall.tool</code> to un-install VirtualBox</li>
<li>Reboot</li>
<li>Re-install Virtualbox using the downloaded installer. </li>
<li>If prompted, go to System Preferences - Privacy - General and accept the extensions</li>
<li>If the PiHole VM is no longer listed in VirtualBox, re-add PiHole Virtual Machine <code>PiHole.vbox</code> file using the 'Add' button in VirtualBox</li>
<li>Reboot</li>
</ol>
<p>Reference: <a href="https://apple.stackexchange.com/q/408154">Apple Stack Exchange</a></p>
<h2 id="troubleshooting-ventura-update-full-disk-accessprivacyother-permissions">Full Disk Access/Privacy/Other Permissions</h2>
<p>macOS Ventura seems to use a different scheme for Privacy, and some apps may not be updated for it. </p>
<p>If required, remove permissions that are requested. </p>
<p>If issues persist, uninstall and reinstall the app. </p>
<h2 id="troubleshooting-ventura-update-scheduled-reboot">Scheduled Reboot</h2>
<div class="admonition quote">
<p class="admonition-title"> </p>
<p>In macOS Ventura, the way you schedule your Mac to shut down or reboot has changed.</p>
<p>In previous versions of macOS, setting an automated schedule like this was easy. You simply had to navigate to the Energy Saver/Battery panel in System Preferences and set a custom schedule using the interface options. For ‌macOS Ventura‌, however, in replacing System Preferences with System Settings, Apple decided to remove these options from the graphical interface completely.</p>
</div>
<p>How to schedule a reboot on Sunday at 4 AM:</p>
<ol>
<li>Open Terminal</li>
<li>Run command:
<div class="highlight"><pre><span></span><code>sudo pmset repeat restart U 04:00:00
</code></pre></div></li>
<li>Enter password if requested</li>
<li>Verify schedule by running command:
<div class="highlight"><pre><span></span><code>pmset -g sched
</code></pre></div></li>
</ol>
<p>To clear the current Power Management schedule, run command:
<div class="highlight"><pre><span></span><code>sudo pmset repeat cancel
</code></pre></div></p>
<p>Reference: <a href="https://www.macrumors.com/how-to/schedule-shut-down-boot-up-macos-ventura/">How to Schedule Shut Down, Restart, and Boot/Wake in macOS Ventura: MacRumors</a></p></section><h1 class='nav-section-title-end'>Ended: Troubleshooting</h1></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href=/MacServer-Documentation/attributions>Attributions</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "/MacServer-Documentation/", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
    
  </body>
</html>