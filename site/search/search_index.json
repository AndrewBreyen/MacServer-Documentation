{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Home"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"first-time-setup/first-time-setup/","text":"Users When first setting up the Mac, create a generic \u201cMacMini\u201d (or whatever type of Mac) admin user. This user will be logged in and serving apps/content. Other users will be created later, but just create this user for now. Network The Mac needs to have a Static IP address. Find the Ethernet Mac Address under Apple Menu (hold OPTION) -> System Information -> Network In modem settings (192.168.0.1) -> Advanced Setup -> DHCP Reservation, enter (or choose) the MAC address and set a static IP (192.168.0.2) In System Preferences -> Network -> Ethernet -> Advanced change \u2018Configure IPv4\u2019 to Using DHCP with manual address. Enter 192.168.0.2 for IP address Reboot mac, and ensure that IP address listed in System Preferences is 192.168.0.2 macOS Settings Enable automatic login for the MacMini user: System Preferences -> Users and Groups -> Login Options Automatically start apps on MacMini user login Docker Jellyfin Energy Saver: Turn Display Off after: never Prevent your Mac from automatically sleeping when the display is off Put hard disks to sleep when possible Wake for network access Start up automatically after a power failure Enable Power Nap Full Disk Access: Ensure /bin/bash has full disk access in System Preferences -> Security and Privacy -> Privacy","title":"First Time Setup"},{"location":"first-time-setup/first-time-setup/#users","text":"When first setting up the Mac, create a generic \u201cMacMini\u201d (or whatever type of Mac) admin user. This user will be logged in and serving apps/content. Other users will be created later, but just create this user for now.","title":"Users"},{"location":"first-time-setup/first-time-setup/#network","text":"The Mac needs to have a Static IP address. Find the Ethernet Mac Address under Apple Menu (hold OPTION) -> System Information -> Network In modem settings (192.168.0.1) -> Advanced Setup -> DHCP Reservation, enter (or choose) the MAC address and set a static IP (192.168.0.2) In System Preferences -> Network -> Ethernet -> Advanced change \u2018Configure IPv4\u2019 to Using DHCP with manual address. Enter 192.168.0.2 for IP address Reboot mac, and ensure that IP address listed in System Preferences is 192.168.0.2","title":"Network"},{"location":"first-time-setup/first-time-setup/#macos-settings","text":"Enable automatic login for the MacMini user: System Preferences -> Users and Groups -> Login Options Automatically start apps on MacMini user login Docker Jellyfin Energy Saver: Turn Display Off after: never Prevent your Mac from automatically sleeping when the display is off Put hard disks to sleep when possible Wake for network access Start up automatically after a power failure Enable Power Nap Full Disk Access: Ensure /bin/bash has full disk access in System Preferences -> Security and Privacy -> Privacy","title":"macOS Settings"},{"location":"first-time-setup/macos-sharing-settings/","text":"macOS Sharing Settings In System Preferences Sharing Settings: File Sharing Add folders: /Users/Shared/macOS Server Shares/AllShare \u200b\u200b/Users/Shared/macOS Server Shares/Scans Add volumes: /Volumes/Media /Volumes/Time Machine Backups Right Click -> advanced options -> Share as a Time Machine backup destination For all locations, allow \u2018Everyone\u2019 to read and write Remote Login [CHECK] Allow full disk access for remote users Allow access for: All users Remote Management Allow access for: All users Computer Settings: [CHECK] Always show Remote Management status in menu bar [CHECK] Anyone may request permission to control screen Remote Apple Events Allow access for: All users Content Caching Cache: All content Options -> Cache size: 30 GB (change as needed)","title":"macOS Sharing Settings"},{"location":"server-apps/homebridge/","text":"Homebridge is used for Home Controls of Plugs, Garage Door. Install locally: https://github.com/homebridge/homebridge/wiki/Install-Homebridge-on-macOS Install plugins: Homebridge Tuya Platform (https://github.com/tuya/tuya-homebridge), Configure plugins: Name: TuyaPlatform Username: andrew.breyen@gmail.com Password: [encrypted-value] Access ID: [encrypted-value] Access Key: [encrypted-value] Language Code: en Project Type: PaaS PaaS Platform: Smart Life Country Code: 1 Once the Homebridge Tuya Platform plugin is added, click the power icon on the top right to restart Once back up, click \u2018Accessories\u2019 and verify that all accessories have been added Scan QR code from Status screen using Home App -> Add Accessories Add the bridge to room \u2018ZAccessories\u2019, continue setup within Home app, place accessories into correct rooms","title":"Homebridge"},{"location":"server-apps/jellyfin/","text":"Jellyfin Jellyfin is used to serve media content, manage and record live TV content, and more. Install Jellyfin locally: https://repo.jellyfin.org/releases/server/macos/stable/ Configure Libraries: Live TV Configuration: Ensure HDHomeRun has a static IP address: Find HDHomeRun MAC address at http://hdhomerun.local/system.html In modem settings (192.168.0.1) -> Advanced Setup -> DHCP Reservation, enter (or choose) the MAC address and set a static IP (whatever IP was already set on the HDHR system menu web page) Setup Live TV according to Jellyfin documentation: https://jellyfin.org/docs/general/server/live-tv/setup-guide.html Add Guide Data: Install Docker Desktop (https://www.docker.com/products/docker-desktop) Create a Docker container for the Zap2XML Docker Container (https://github.com/shuaiscott/zap2xml) Create a folder /Users/Shared/xmltvdata Open Docker Desktop app In Settings -> Resources -> File Sharing add the /Users/Shared/xmltvdata folder created in step 1 Run terminal command: replace your_zap2it_email@email.com and your_zap2it_password with your https://tvlistings.zap2it.com/ account details. By default, new guide data will be fetched by this Docker container every 12 hours. Additional command line arguments can be added/changed. See details on GitHub - shuaiscott/zap2xml README. docker run \"-d --name zap2xml -v /xmltvdata:/data -e USERNAME=your_zap2it_email@email.com -e PASSWORD=your_zap2it_password -e OPT_ARGS=\"-I -D -Z 55303\" -e XMLTV_FILENAME=xmltv.xml shuaiscott/zap2xml\" Open Docker Desktop and view logs, let it run. When complete, a status message will print like this: Downloaded 1090062 bytes in 291 http requests using 2 sockets. Writing XML file: /data/xmltv.xml Completed in 167s (Parse: 164s) 81 stations, 7895 programs, 17063 scheduled. Last run time: Fri Mar 11 04:12:49 UTC 2022 Will run in 43200 seconds In macOS Finder, verify that a xmltv.xml file was created at location /Users/Shared/xmltvdata. File should start with something like: 2.1 KTCADT 2.1 KTCADT Scroll down past the <channel></channel> sections, and verify that there are </programme></programme> tags, with contents similar to Endeavour: The Evolution A look at how \u2026.. Documentary Special 90 https://tvlistings.zap2it.com//overview.html?programSeriesId=SH04161006&tmsId=SH041610060000 SH04161006.0000 Once the file looks correct, it can be added into Jellyfin. See details on Setup Guide | Documentation - Jellyfin Project","title":"Jellyfin"},{"location":"server-apps/macos-server/","text":"macOS Server Create users within macOS Server app for Dan/Nancy/Matt/Andrew","title":"macOS Server"},{"location":"server-apps/node-red/","text":"Node-RED Node-RED is used to control automations that require more settings/control than HomeKit or HomeBridge can provide natively. \u201cNode-RED is a programming tool for wiring together hardware devices, APIs and online services in new and interesting ways. It provides a browser-based editor that makes it easy to wire together flows using the wide range of nodes in the palette that can be deployed to its runtime in a single-click.\u201d Installation: Install Node-RED locally using directions provided here: https://nodered.org/docs/getting-started/local Additional Palette items: Once Node-RED is running and you can access via a web browser, install these additional items by clicking the three lines hamburger button in the top right, and selecting \u2018Manage Palette\u2019, then move to the \u2018Install\u2019 tab node-red node-red-contrib-cron node-red-contrib-homebridge-automation node-red-contrib-slack-files node-red-contrib-stoptimer Enabling Node-RED to start on computer boot Follow directions here to use pm2 to have Node-RED start on boot: https://nodered.org/docs/faq/starting-node-red-on-boot Importing Flows Go to https://github.com/AndrewBreyen/Node-RED-flows/ and pick which flow you want to start importing Copy the contents of desired flows\u2019 (use the button for ease of use) Click the three lines hamburger button in the top right, and selecting \u2018Import\u2019 Paste in value copied to clipboard Go to https://api.slack.com/apps/A03JPNEBPC4/incoming-webhooks to retrieve the Webhook URL, copy to clipboard Double click on the node(s) Paste in the Webhook URL copied to clipboard Double click on the and nodes, ensure that the correct device and Homebridge Pin are selected Repeat with the other flows you want to import Test it out!","title":"Node-RED"},{"location":"server-apps/pihole/","text":"Pihole Pihole is used as a network wide Ad blocker using DNS. Create a Virtualbox VM for PiHole (these are purposefully low-powered settings, it\u2019s designed for a Raspberry Pi, so a powerful VM is not needed) 1 GB memory 10 GB storage bridged network 50% CPU Execution cap Download ISO of LTS edition from https://ubuntu.com/download/server Add ISO as a boot medium Settings of VM -> Storage Controller: IDE -> Empty Click the circle CD icon and pick \u2018choose a disk file\u2026\u2019 Pick the downloaded ISO Click OK Start VM in headless mode (click arrow next to start -> headless mode) Install Ubuntu Server with default settings, pihole user, password pihole When asked for the network settings, take note of the MAC address and add a IP reservation to modem settings After applying assigned IP, reset the VM and restart setup. This will force the VM to get a static IP. If this doesn't work, continue with setup, and do \u201cconfigure a static IP for VM'' setup below Configure a Static IP for the VM Set static IP on APTC via MAC address (MAC address listed under $[ip addr]) RUN: sudo nano /etc/netplan/00-installer-config.yaml Copy these contents into the file that is generated, change IP address as needed This is the network config written by 'subiquity' network: version: 2 ethernets: enp0s3: addresses: - IP ADDRESS SET ON MODEM /24 gateway4: 10.0.1.1 nameservers: addresses: - 10.0.1.53 - 8.8.4.4 RUN: sudo netplan generate RUN: sudo netplan apply RUN: reboot Install PiHole: https://github.com/pi-hole/pi-hole/#curl--ssl-httpsinstallpi-holenet--bash Set the IP address of the VM as the DHCP server in: modem settings (192.168.0.1) -> Advanced Setup -> DHCP Settings -> Set the DNS servers allocated with DHCP requests. -> Custom Servers -> enter VM ip address as server 1, and Open DNS backup server (8.8.4.4) as server 2 Set the VM to auto-login (https://askubuntu.com/a/819154) RUN: sudo systemctl edit getty@tty1.service Edit the file that is generated with these contents, change username to username of VM user: [Service] ExecStart= ExecStart=-/sbin/agetty --noissue --autologin pihole %I $TERM Type=idle Save with CTRL + X Reboot machine and see if it auto-logs in as Pihole user Set the VM to auto-launch in headless mode on Mac login: Download the script vboxlaunchagent.sh from https://www.whatroute.net/software/vboxlaunchagent.sh.zip Directions from this website: LaunchAgents are configured with an Apple plist XML file installed in the users Library/LaunchAgents folder. When the user logs in to their account on the Mac, launchd will inspect these plist files and invoke the required program with specified arguments. It can get a bit tricky to create a plist manually. They have very fussy and very unforgiving syntax requirements. This shell script will create the plist and install it in the LaunchAgents directory. You can download the script from vboxlaunchagent.sh. Unzip the file and copy the script to a suitable directory on your machine. Run the script using this syntax: Find the name of the VM: In a terminal, run: VBoxManage list vms macmini@macserver ~ % VBoxManage list vms \"Pihole\" {c7ac734f-3fc7-4645-997b-3c78ef32d8f4} In this example, Pihole is the name of the VM. In a terminal, run sh vboxlaunchagent.sh --headless --verbose \"VMName\", replacing \u2018VMName\u2019 with the name of the VM from the previous step Reboot the Mac and ensure the VM auto-starts on login Troubleshooting Sites not Loading Pihole is a tracking and ad-blocker. Because of this, some sites may not load, or be missing content. Updating Pihole If you see red text at the bottom of the PiHole web UI \u2018Update Available\u2019, it needs an update. This is currently a manual process, work in progress to automate it. There are two options, both do exactly the same thing. The SSH option may be easier. Via SSH: Open a Terminal and enter command: ssh pihole@pi.hole If you get a message similar to: The authenticity of host 'pi.hole (192.168.0.4)' can't be established. ED25519 key fingerprint is SHA256:jWxxjslC9ObhMty4d0UNERghKP6UWmetfEj80CKW6QY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:8: 192.168.0.4 Are you sure you want to continue connecting (yes/no/[fingerprint])? this is likely because you have not connected to the PiHole VM using SSH previously. Verify the IP address is 192.168.0.4 and if it\u2019s correct, type \u2018yes\u2019 at the prompt. At the prompt pihole@pi.hole's password: enter the PiHole user password. Once successfully connected, you should see a prompt similar to pihole@pihole:~$. You are now SSHed into the PiHole VM Run command pihole -up If prompted [sudo] password for pihole: enter the PiHole user password Wait for it to update. On success, you should see [\u2713] Everything is up to date! It\u2019s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 91 updates can be applied immediately. 9 of these updates are standard security updates. To do this: Run sudo apt upgrade You may be prompted \u2018After this operation, 430 MB of additional disk space will be used. Do you want to continue? [Y/n]\u2019 Enter \u2018y\u2019 Wait for it to update. This may take a while, depending on the number of updates Via Apple Remote Desktop: Open Apple Remote Desktop Select \u2018MacServer\u2019 from All Computers Click on \u2018Control\u2019 or from the taskbar, choose Interact > Control or Interact > Control A new window will open with the MacServer display. From the Dock, Applications Folder or Spotlight, open VirtualBox Ensure \u2018Pihole\u2019 is selected in the sidebar Click \u2018Show\u2019 A new window will open with the PiHole VM. In that new window, ensure you have a pihole@pihole:~$ prompt. If you do not, press enter a few times to get to a new line. Run command pihole -up If prompted [sudo] password for pihole: enter the PiHole user password Wait for it to update. On success, you should see [\u2713] Everything is up to date! It\u2019s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 91 updates can be applied immediately. 9 of these updates are standard security updates. To do this: Run sudo apt upgrade You may be prompted \u2018After this operation, 430 MB of additional disk space will be used. Do you want to continue? [Y/n]\u2019 Enter \u2018y\u2019 Wait for it to update. This may take a while, depending on the number of updates","title":"Pihole"},{"location":"server-apps/pihole/#this-is-the-network-config-written-by-subiquity","text":"network: version: 2 ethernets: enp0s3: addresses: - IP ADDRESS SET ON MODEM /24 gateway4: 10.0.1.1 nameservers: addresses: - 10.0.1.53 - 8.8.4.4 RUN: sudo netplan generate RUN: sudo netplan apply RUN: reboot Install PiHole: https://github.com/pi-hole/pi-hole/#curl--ssl-httpsinstallpi-holenet--bash Set the IP address of the VM as the DHCP server in: modem settings (192.168.0.1) -> Advanced Setup -> DHCP Settings -> Set the DNS servers allocated with DHCP requests. -> Custom Servers -> enter VM ip address as server 1, and Open DNS backup server (8.8.4.4) as server 2 Set the VM to auto-login (https://askubuntu.com/a/819154) RUN: sudo systemctl edit getty@tty1.service Edit the file that is generated with these contents, change username to username of VM user: [Service] ExecStart= ExecStart=-/sbin/agetty --noissue --autologin pihole %I $TERM Type=idle Save with CTRL + X Reboot machine and see if it auto-logs in as Pihole user Set the VM to auto-launch in headless mode on Mac login: Download the script vboxlaunchagent.sh from https://www.whatroute.net/software/vboxlaunchagent.sh.zip Directions from this website: LaunchAgents are configured with an Apple plist XML file installed in the users Library/LaunchAgents folder. When the user logs in to their account on the Mac, launchd will inspect these plist files and invoke the required program with specified arguments. It can get a bit tricky to create a plist manually. They have very fussy and very unforgiving syntax requirements. This shell script will create the plist and install it in the LaunchAgents directory. You can download the script from vboxlaunchagent.sh. Unzip the file and copy the script to a suitable directory on your machine. Run the script using this syntax: Find the name of the VM: In a terminal, run: VBoxManage list vms macmini@macserver ~ % VBoxManage list vms \"Pihole\" {c7ac734f-3fc7-4645-997b-3c78ef32d8f4} In this example, Pihole is the name of the VM. In a terminal, run sh vboxlaunchagent.sh --headless --verbose \"VMName\", replacing \u2018VMName\u2019 with the name of the VM from the previous step Reboot the Mac and ensure the VM auto-starts on login Troubleshooting Sites not Loading Pihole is a tracking and ad-blocker. Because of this, some sites may not load, or be missing content. Updating Pihole If you see red text at the bottom of the PiHole web UI \u2018Update Available\u2019, it needs an update. This is currently a manual process, work in progress to automate it. There are two options, both do exactly the same thing. The SSH option may be easier. Via SSH: Open a Terminal and enter command: ssh pihole@pi.hole If you get a message similar to: The authenticity of host 'pi.hole (192.168.0.4)' can't be established. ED25519 key fingerprint is SHA256:jWxxjslC9ObhMty4d0UNERghKP6UWmetfEj80CKW6QY. This host key is known by the following other names/addresses: ~/.ssh/known_hosts:8: 192.168.0.4 Are you sure you want to continue connecting (yes/no/[fingerprint])? this is likely because you have not connected to the PiHole VM using SSH previously. Verify the IP address is 192.168.0.4 and if it\u2019s correct, type \u2018yes\u2019 at the prompt. At the prompt pihole@pi.hole's password: enter the PiHole user password. Once successfully connected, you should see a prompt similar to pihole@pihole:~$. You are now SSHed into the PiHole VM Run command pihole -up If prompted [sudo] password for pihole: enter the PiHole user password Wait for it to update. On success, you should see [\u2713] Everything is up to date! It\u2019s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 91 updates can be applied immediately. 9 of these updates are standard security updates. To do this: Run sudo apt upgrade You may be prompted \u2018After this operation, 430 MB of additional disk space will be used. Do you want to continue? [Y/n]\u2019 Enter \u2018y\u2019 Wait for it to update. This may take a while, depending on the number of updates Via Apple Remote Desktop: Open Apple Remote Desktop Select \u2018MacServer\u2019 from All Computers Click on \u2018Control\u2019 or from the taskbar, choose Interact > Control or Interact > Control A new window will open with the MacServer display. From the Dock, Applications Folder or Spotlight, open VirtualBox Ensure \u2018Pihole\u2019 is selected in the sidebar Click \u2018Show\u2019 A new window will open with the PiHole VM. In that new window, ensure you have a pihole@pihole:~$ prompt. If you do not, press enter a few times to get to a new line. Run command pihole -up If prompted [sudo] password for pihole: enter the PiHole user password Wait for it to update. On success, you should see [\u2713] Everything is up to date! It\u2019s also a good idea to update the underlying Ubuntu instance periodically, especially if there is a notice then you logged into the Pihole VM similar to: 91 updates can be applied immediately. 9 of these updates are standard security updates. To do this: Run sudo apt upgrade You may be prompted \u2018After this operation, 430 MB of additional disk space will be used. Do you want to continue? [Y/n]\u2019 Enter \u2018y\u2019 Wait for it to update. This may take a while, depending on the number of updates","title":"This is the network config written by 'subiquity'"},{"location":"server-apps/scrypted/","text":"Scrypted Scrypted is used to serve Video Camera Content to Apple Home. Install locally: https://github.com/koush/scrypted/wiki/Installation:-Mac Install plugins: HomeKit, RTSP Camera Plugin, Rebroadcast Plugin Configure plugins: RTSP cameras Add 2 cameras (Front Porch, Backyard), username: wyzecam, Password: wyzecam, Snapshot URL: [blank], RTSP Stream URL: rtsp://wyzecam:wyzecam@[IP ADDR OF CAMERA]/live Homekit View console of plugin to see QR code, add accessory via iOS Home app. Add the bridge to room \u2018ZAccessories\u2019, continue setup within Home app, place accessories into correct rooms Additional apps used by Scrypted: OpenCV: https://opencv.org/ Used to detect motion and send homekit notifications","title":"scrypted"},{"location":"server-apps/teamviewer/","text":"TeamViewer Teamviewer is used for Remote Desktop access to the computer off-network. Install TeamViewer from https://www.teamviewer.com/en-us/download/mac-os/ Login with account andrew.breyen@gmail.com Enable unattended access: [CHECK] Start TeamViewer with System [CHECK] Grant Andrew Breyen Easy Access","title":"TeamViewer"},{"location":"troubleshooting/live-tv-data-not-up-to-date/","text":"Live TV Guide Data not up to date Use Remote Desktop to connect to the computer: Ensure that the Docker Container is healthy and running Open Docker Desktop, restart the container If the container will not run, delete and recreate the Container per Live TV Configuration setup instructions If container is setup, running, and healthy: Open the file (/Users/Shared/xmltvdata/xmltv.xml) with a text editor and see if the file has up to date data. If the file does have up to date data but Jellyfin does not have updated data: Open Jellyfin Admin Dashboard (web console) -> Live TV and ensure file is listed under TV Guide Data Providers If the file is listed: Ensure that the Scheduled Task Live TV / Refresh Guide has run recently, and is scheduled to run at least every 12 hours (11am/11pm)","title":"Live TV Guide Data Issues"},{"location":"troubleshooting/no-response-homekit/","text":"Smart Devices showing as \u201cNo Response\u201d/Orange Exclamation mark in Apple Home This is usually caused by your device, not MacServer. Try rebooting your device. If it still shows an issue, check that HomeBridge/Scrypted are online and aren\u2019t throwing any errors.","title":"Smart Devices showing as \u201cNo Response\u201d/Orange Exclamation mark"},{"location":"troubleshooting/reboot/","text":"Reboot Most issues can be solved by rebooting the Mac. If configured correctly, the mac should auto-login and all services should auto-start upon boot. To reboot the machine, there are a couple different ways: Easiest - Apple Remote Desktop (ARD) Open ARD Select \u2018MacServer\u2019 in the list Choose Manage -> Restart Select \u2018Users lose unsaved changes\u2019 Click Restart After the Mac has restarted, \u2018Current Status\u2019 should change to \u2018Available\u2019 SSH Use Terminal on a Mac, or \u201cTermius\u201d iOS app Connect to MacServer over ssh: In a terminal: ssh macmini@macserver.local At prompt: (macmini@macserver.local) Password: enter MacMini user password (no characters will be shown when typed) Connection success if prompt changes to macserver:~ macmini$ Enter sudo shutdown -r now at prompt Enter macmini user password Final shutdown message will be shown: Shutdown NOW! FINAL System shutdown message from macmini@macserver.local System going down IMMEDIATELY System shutdown time has arrived Connection to macserver.local closed by remote host. Connection to macserver.local closed.","title":"Reboot"}]}